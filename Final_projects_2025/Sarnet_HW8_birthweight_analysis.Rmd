---
title: "Анализ веса новорожденных"
author: "Сарнэт Виктория ББ5А23/10"
date: "2026-01-07"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE)
library(ggplot2)
library(dplyr)
library(knitr)
```

**Введение**

Вес новорожденного является важным показателем здоровья ребенка и может быть индикатором различных факторов риска. Многочисленные исследования указывают на то, что образ жизни матери, включая курение, а также демографические характеристики, такие как возраст и раса, могут оказывать значительное влияние на массу тела ребенка при рождении.


**Цель исследования:** Изучить влияние возраста матери и таких факторов, как раса и курение, на вес новорожденных.

Основные вопросы исследования:

1. Различается ли вес новорожденного у молодых матерей (21 год и моложе) и взрослых женщин (старше 21 года)?

2. Существует ли взаимосвязь веса младенца с расой матери (афроамериканцы vs белые) и курением матери?


**Материал и методика**

В исследовании использовались данные о 189 беременностях, полученные из базы данных birthwt. Данные содержат информацию о матерях и их новорожденных.

```{r load_data}
#Загрузка данных
data <- read.csv("birthwt.csv", sep = ";")

#Преобразование переменных в факторы
data$race <- factor(data$race, 
                    levels = c(1, 2, 3),
                    labels = c("Белые", "Афроамериканцы", "Другие"))

data$smoke <- factor(data$smoke,
                     levels = c(0, 1),
                     labels = c("Некурящие", "Курящие"))

data$ht <- factor(data$ht, levels = c(0, 1), labels = c("Нет", "Да"))
data$ui <- factor(data$ui, levels = c(0, 1), labels = c("Нет", "Да"))

#Создание возрастной группы
data$age_group <- ifelse(data$age <= 21, "Молодые (≤21)", "Взрослые (>21)")
data$age_group <- factor(data$age_group)

#Проверка структуры данных
cat("Структура данных:\n")
str(data[, c("age", "age_group", "race", "smoke", "bwt")])
```

**Методы статистического анализа**

Для анализа данных использовались следующие методы:

1. Описательная статистика - для характеристики выборки
2. t-критерий Стьюдента - для сравнения веса новорожденных у двух возрастных групп
3. Двухфакторный дисперсионный анализ (ANOVA)** - для оценки влияния расы и курения на вес новорожденных
4. Визуализация данных - для наглядного представления результатов


**Результаты**

Описательная статистика

```{r descriptive_stats}
#Сводная таблица описательной статистики
desc_stats <- data %>%
  group_by(age_group) %>%
  summarise(
    n = n(),
    mean_bwt = round(mean(bwt), 1),
    sd_bwt = round(sd(bwt), 1),
    min_bwt = min(bwt),
    max_bwt = max(bwt),
    .groups = 'drop')

# Отображение таблицы
cat("Таблица 1: Описательная статистика веса новорожденных по возрастным группам\n")
print(desc_stats)
```

**Визуализация распределения веса новорожденных**

```{r visualization, fig.cap="Распределение веса новорожденных в разных возрастных группах", fig.height=5}
#Создание боксплота
ggplot(data, aes(x = age_group, y = bwt, fill = age_group)) +
  geom_boxplot(alpha = 0.7) +
  geom_jitter(width = 0.2, alpha = 0.5, size = 1.5) +
  labs(
    title = "Вес новорожденных у молодых и взрослых матерей",
    x = "Возрастная группа матери",
    y = "Вес новорожденного (г)",
    fill = "Возрастная группа") +
  scale_fill_manual(values = c("Молодые (≤21)" = "lightblue", 
                               "Взрослые (>21)" = "lightcoral")) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold"))
```


1.Сравнение веса новорожденных у молодых и взрослых матерей

```{r t_test}
#Разделение данных по возрастным группам
young_data <- data %>% filter(age_group == "Молодые (≤21)")
adult_data <- data %>% filter(age_group == "Взрослые (>21)")

#Проведение t-теста
t_test_result <- t.test(young_data$bwt, adult_data$bwt, 
                        var.equal = FALSE)

#Вывод результатов
cat("Таблица 2: Результаты t-теста для сравнения веса новорожденных\n")
cat("-------------------------------------------------------------\n")
cat("t-статистика:", round(t_test_result$statistic, 3), "\n")
cat("Степени свободы:", round(t_test_result$parameter, 1), "\n")
cat("p-value:", format.pval(t_test_result$p.value, digits = 3), "\n")
cat("Доверительный интервал (95%): [", 
    round(t_test_result$conf.int[1], 1), ",", 
    round(t_test_result$conf.int[2], 1), "]\n")
cat("Среднее в группе молодых матерей:", round(mean(young_data$bwt), 1), "г\n")
cat("Среднее в группе взрослых матерей:", round(mean(adult_data$bwt), 1), "г\n")
cat("Разница средних:", round(mean(adult_data$bwt) - mean(young_data$bwt), 1), "г\n")

#Интерпретация
if (t_test_result$p.value < 0.05) {
  cat("\nСтатистически значимая разница: ДА (p < 0.05)\n")
} else {
  cat("\nСтатистически значимая разница: НЕТ (p ≥ 0.05)\n")}
```


2.Двухфакторный дисперсионный анализ: раса и курение

```{r anova_analysis}
#Подготовка данных для ANOVA (только белые и афроамериканцы)
anova_data <- data %>% 
  filter(race %in% c("Белые", "Афроамериканцы")) %>%
  mutate(race = droplevels(race))

#Проведение двухфакторного ANOVA
anova_model <- aov(bwt ~ race * smoke, data = anova_data)

#Вывод результатов ANOVA
cat("Таблица 3: Результаты двухфакторного дисперсионного анализа (ANOVA)\n")
cat("-------------------------------------------------------------------\n")
anova_summary <- summary(anova_model)
print(anova_summary)
```
```{r interaction_plot, fig.cap="Взаимодействие расы и курения на вес новорожденных", fig.height=5}
#График взаимодействия
ggplot(anova_data, aes(x = smoke, y = bwt, color = race, group = race)) +
  stat_summary(fun = mean, geom = "point", size = 3) +
  stat_summary(fun = mean, geom = "line", size = 1) +
  labs(
    title = "Взаимодействие расы матери и курения на вес новорожденных",
    x = "Курение во время беременности",
    y = "Средний вес новорожденного (г)",
    color = "Раса матери") +
  scale_color_manual(values = c("Белые" = "blue", "Афроамериканцы" = "red")) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    plot.title = element_text(hjust = 0.5, face = "bold"))
```
```{r group_means}
#Расчет средних значений для разных комбинаций факторов
group_means <- anova_data %>%
  group_by(race, smoke) %>%
  summarise(
    n = n(),
    mean_bwt = round(mean(bwt), 1),
    sd_bwt = round(sd(bwt), 1),
    .groups = 'drop')

cat("Таблица 4: Средний вес новорожденных по расе и курению\n")
print(group_means)
```


**Обсуждение**

1. Влияние возраста матери на вес новорожденного

На основе проведенного анализа можно сделать следующие выводы относительно первого исследовательского вопроса:

`r if (t_test_result$p.value < 0.05) {
"Результаты t-теста показали статистически значимую разницу в весе новорожденных между молодыми (21 год и моложе) и взрослыми (старше 21 года) матерями."
} else {
"Результаты t-теста не выявили статистически значимой разницы в весе новорожденных между молодыми и взрослыми матерями."
}`

Разница в среднем весе составила `r round(abs(mean(adult_data$bwt) - mean(young_data$bwt)), 1)` грамм, при этом `r if (mean(adult_data$bwt) > mean(young_data$bwt)) {
"взрослые матери рожали детей с большим весом"
} else {
"молодые матери рожали детей с большим весом"
}`.

2. Влияние расы и курения на вес новорожденного

Результаты двухфакторного дисперсионного анализа позволяют ответить на второй исследовательский вопрос:

```{r interpretation}
#Автоматическая интерпретация результатов ANOVA
race_p <- anova_summary[[1]]$"Pr(>F)"[1]
smoke_p <- anova_summary[[1]]$"Pr(>F)"[2]
interaction_p <- anova_summary[[1]]$"Pr(>F)"[3]
```


**Основные выводы:**

1. Влияние расы: 
`r if (race_p < 0.05) {
"Раса матери оказывает статистически значимое влияние на вес новорожденного (p < 0.05)."
} else {
"Раса матери не оказывает статистически значимого влияния на вес новорожденного (p ≥ 0.05)."
}`

2. Влияние курения: 
`r if (smoke_p < 0.05) {
"Курение матери во время беременности оказывает статистически значимое влияние на вес новорожденного (p < 0.05)."
} else {
"Курение матери во время беременности не оказывает статистически значимого влияния на вес новорожденного (p ≥ 0.05)."
}`

3. Взаимодействие расы и курения:
`r if (interaction_p < 0.05) {
"Обнаружено статистически значимое взаимодействие между расой и курением (p < 0.05), что означает, что эффект курения на вес новорожденного зависит от расы матери."
} else {
"Взаимодействие между расой и курением не является статистически значимым (p ≥ 0.05), что означает, что эффекты этих факторов аддитивны."}`

**Ограничения исследования**

1. Исследование носит наблюдательный характер, поэтому нельзя делать выводы о причинно-следственных связях.
2. В анализе не учитывались другие потенциально важные факторы, такие как питание матери, социально-экономический статус и качество медицинского обслуживания.
3. Размер выборки может быть недостаточным для выявления небольших эффектов.

**Выводы**

1. `r if (t_test_result$p.value < 0.05) {
"Вес новорожденных статистически значимо различается между молодыми и взрослыми матерями."
} else {
"Вес новорожденных не имеет статистически значимых различий между молодыми и взрослыми матерями."}`

2. `r if (race_p < 0.05 | smoke_p < 0.05) {
paste0(
  "Вес новорожденного связан с ",
  if (race_p < 0.05) "расой матери" else "",
  if (race_p < 0.05 & smoke_p < 0.05) " и " else "",
  if (smoke_p < 0.05) "курением матери" else "",
  ".")} else {
"Вес новорожденного не связан ни с расой матери, ни с курением."}`

`r if (interaction_p < 0.05) {
"Эффект курения на вес новорожденного зависит от расы матери."}`