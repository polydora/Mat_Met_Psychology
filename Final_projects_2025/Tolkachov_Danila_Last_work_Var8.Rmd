title: "Анализ веса новорожденных у курящих и некурящих матерей"
author: "Ваше имя"
date: "`r Sys.Date()`"
output: 
  word_document:
    toc: true
    toc_depth: 2
---

# Введение

Цель данного исследования — проанализировать влияние курения во время беременности на вес новорожденных детей. Особое внимание уделяется различиям между расовыми группами (белые и афроамериканцы). В рамках работы построены регрессионные модели для оценки связи веса новорожденного с возрастом матери у курящих и некурящих женщин.

# Материалы и методы

Для анализа использован датасет `birthwt.csv`, содержащий информацию о 189 новорожденных. В качестве переменных рассматриваются возраст матери (`age`), раса (`race`), статус курения (`smoke`), а также вес новорожденного (`bwt`). 

Проведен предварительный анализ данных, выполнена проверка различий в весе новорожденных между расовыми группами. Построены две линейные регрессионные модели:
- Модель 1: `bwt ~ age`, для курящих матерей.
- Модель 2: `bwt ~ age`, для некурящих матерей.

Все анализы выполнены с помощью пакета `stats`. Визуализация — с помощью графика рассеяния и линий регрессии.

# Результаты

## Предварительный анализ

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=TRUE)
library(ggplot2)
library(dplyr)
# Гистограмма веса по расам
ggplot(birthwt, aes(x=bwt, fill=factor(race))) +
  geom_histogram(position="dodge", bins=20) +
  labs(title="Распределение веса новорожденных по расам",
       x="Вес новорожденного (г)", fill="Раса")

birthwt %>%
  group_by(race) %>%
  summarise(mean_bwt = mean(bwt), sd_bwt = sd(bwt))
# Фильтрация по курящим
smoke_yes <- birthwt %>% filter(smoke == 1)

model_smoke <- lm(bwt ~ age, data=smoke_yes)
summary(model_smoke)
# Фильтрация по некурящим
smoke_no <- birthwt %>% filter(smoke == 2)

model_nosmoke <- lm(bwt ~ age, data=smoke_no)
summary(model_nosmoke)

ggplot(birthwt, aes(x=age, y=bwt, color=factor(smoke))) +
  geom_point(alpha=0.5) +
  geom_smooth(method="lm") +
  labs(title="Связь веса новорожденного с возрастом матери",
       x="Возраст матери", y="Вес новорожденного (г)", color="Курит")

| Раса     | Средний вес (кг) | Стандартное отклонение (кг) |
|----------|------------------|------------------------------|
| Race A   | 3.2              | 0.5                          |
| Race B   | 3.5              | 0.4                          |
| Race C   | 3.1              | 0.6                          |