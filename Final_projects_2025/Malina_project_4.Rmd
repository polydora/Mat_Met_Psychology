---
title: "Проект №4"
author: "Малина Лада"
date: "2025-06-01"
output: word_document
bibliography: ДЗ.bib
---

```{r Установки, include=FALSE}
library(knitr)

opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```


# Введение
  
В первые месяцы жизни грудное молоко является основным источником питания для новорожденных.  Объем потребляемого молока может зависеть от различных факторов, как связанных с ребенком (пол, вес), так и с матерью (вес, рост).  В данном исследовании я анализирую влияние этих факторов на объем потребляемого молока.

# Материалы и методы

В проекте используются пакеты ggplot2 [@ggplot], dplyr [@dplyr], ISwR [@ISwR], car [@car], broom [@broom].
Также в исследовании использовался датасет "kfm".  Датасет содержит информацию о 50 кормящих матерях и их детях. Я исследовала связь между объемом потребляемого молока (dl.milk) и полом ребенка (sex), весом ребенка (weight), и весом матери (mat.weight).

```{r Пакеты}
# install.packages("ISwR")
library(ISwR)
# install.packages("dplyr")
library(dplyr)
library(car)
library(ggplot2)
library(broom)
```


Для анализа различий в объеме потребляемого молока между мальчиками и девочками использовался t-тест. Также были построены две линейные регрессионные модели:

1. dl.milk ~ weight (связь объема потребляемого молока с весом ребенка)
2. dl.milk ~ mat.weight (связь объема потребляемого молока с весом матери)

# Результаты
## Сравнение потребления молока по полу

```{r t_test}
setwd("D:/Mat_Met_Biology")
data(kfm)
t_test_result <- t.test(dl.milk ~ sex, data = kfm)
t_test_result

```
Нулевая гипотеза: статистически значимых различий в объеме потребляемого молока между мальчиками и девочками нет. Если p.value < 0.05, то результаты t-теста показывают статистически значимые различия в объеме потребляемого молока между мальчиками и девочками. Если p.value > 0.05, то результаты t-теста не показывают статистически значимых различий в объеме потребляемого молока между мальчиками и девочками.В данном случае p < 0.05, поэтому различия есть.

## Регрессионные модели

1. Объём молока и вес ребёнка

```{r 1_регрессионная_модель}
model1 <- lm(dl.milk ~ weight, data = kfm) 
summary(model1)
```

Результаты регрессионного анализа показывают, что вес ребенка является статистически значимым предиктором объема потребляемого молока (p < 0.05). Уравнение регрессии имеет вид:

$$
dl.milk = b_0 + b_1 \times  weight + \varepsilon
$$
2. Объем молока и вес матери
```{r 2_регрессионная модель}
model2 <- lm(dl.milk ~ mat.weight, data = kfm)
summary(model2)
```

Результаты регрессионного анализа показывают, что вес матери также является статистически значимым предиктором объема потребляемого молока (p < 0.05).


## Графики

```{r график1}
library(ggplot2)
ggplot(kfm, aes(x = weight, y = dl.milk)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(x = "Вес ребенка (kg)", y = "Объем молока (dl/24h)",
       title = "Зависимость объема потребляемого молока от веса ребенка")
```

```{r график2}
library(ggplot2)
ggplot(kfm, aes(x = mat.weight, y = dl.milk)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red") + 
  labs(x = "Вес матери (kg)", y = "Объем молока (dl/24h)",
       title = "Зависимость объема потребляемого молока от веса матери")
```



## Анализ валидности модели 1



```{r, fig.cap="Квантильный график 1"}
qqPlot(model1, id = FALSE)
```

Отклонений от нормальности распределения нет.

```{r, fig.cap="График рассеивания остатков 1"}
diagn_df <- fortify(model1)

ggplot(diagn_df, aes(x = .fitted, y = .stdresid)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  geom_smooth()
```

Нарушений нет.

## Анализ валидности модели 2

```{r, fig.cap="Квантильный график 2"}
qqPlot(model2, id = FALSE)
```


Отклонений от нормальности распределения нет.


```{r, fig.cap="График рассеивания остатков 2"}
diagn_df <- fortify(model2)

ggplot(diagn_df, aes(x = .fitted, y = .stdresid)) +
  geom_point() +
  geom_hline(yintercept = 0) +
  geom_smooth()
```


Нарушений нет.


## Таблица


```{r таблица}

df_summary <- tidy(model1)

kable(df_summary, caption = "Таблица 1. Параметры регрессионной модели.")
```


```{r}
df_summary <- tidy(model2)

kable(df_summary, caption = "Таблица 2. Параметры регрессионной модели.")
```


# Обсуждение
Проведенный анализ показывает, что есть статистически значимые различия в объеме потребляемого молока между мальчиками и девочками. Вес ребенка а также вес матери оказывают значимое влияние на объем потребляемого молока.

Связи между изученными параметрами описываются следующими моделями:

1.
$$
dl.milk = -1.82 + 1.75 \times weight + \varepsilon
$$

2.
$$
dl.milk = 2.81 + 0.08 \times mat.weight + \varepsilon
$$
Необходимо отметить, что исследование проводилось на небольшой выборке, что ограничивает возможность обобщения результатов.



# Библиография

