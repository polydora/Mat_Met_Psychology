---
title: "Влияния курения и расовой на вес новорожденных детей"
author: "Цуранова Е.А."
output:
  word_document:
    reference_docx: template.docx
bibliography: bibliography.bib
csl: gost-r-7-0-5-2008.csl
---
```{r setup, include=FALSE}
library(readxl)
library(ggplot2)
library(dplyr)
library(knitr)
knitr::opts_chunk$set(echo = FALSE)
```

# Введение

Вес новорождённого является одним из ключевых показателей здоровья детей и важным показателем дальнейшего физического и когнитивного развития ребенка. Курение матери одно из наиболее значимых модифицируемых факторов риска снижения массы тела ребенка при рождении, поскольку никотин и продукты горения табака могут нарушать плацентарный кровоток и снабжение плода кислородом [@horta_1997].

Помимо этого, масса тела новорождённых может быть статистически значимо различаться между расовыми группами матерей [@alexander_1999].

В данной работе был проведён анализ различий массы тела новорождённых у матерей разных рас, а также исследована связь веса младенца с возрастом матери для курящих и некурящих женщин с использованием линейных регрессионных моделей.

# Материал и методы

В работе использовались данные о весе новорождённых и характеристиках матерей, включая возраст, расу и факт курения [@tager_1979].  
Для анализа применялись: двухвыборочный *t-тест Уэлча* и двухвыборочный *t-тест Стьюдента* [@ruxton_2006].

## Математические методы

Для анализа различия веса новорождённых у матерей разных раз применялась следующая формула:

$$
t = \frac{\bar{x}_1 - \bar{x}_2}{\sqrt{\frac{s_1^2}{n_1} + \frac{s_2^2}{n_2}}}
$$
Для анализа зависимости веса новорождённого от возраста матери использовалась линейная регрессионная модель вычисляемая по формуле:

$$
bwt = \beta_0 + \beta_1 \cdot age + \varepsilon
$$
```{r, echo=FALSE, warning=FALSE, message=FALSE,include=FALSE}
birthwt <- read.csv("Data/birthwt.csv", sep = ";")
```

# Результаты

## Сравнение веса новорожденных у белых и афроамериканских матерей

Результаты *t-теста Уэлча* показали статистически значимое различие между группами (t = 2.63, df = 44.24, **p = 0.0117**).

```{r test1, echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
tapply(birthwt$bwt, birthwt$race, mean)

white <- birthwt %>% filter(race == 1) %>% pull(bwt)
black <- birthwt %>% filter(race == 2) %>% pull(bwt)

t.test(white, black)
```

```{r table1, echo=FALSE, warning=FALSE, message=FALSE}
table_race <- birthwt %>%
  filter(race %in% c(1,2)) %>%
  group_by(race) %>%
  summarise(n = n(),
            mean_bwt = round(mean(bwt),1),
            sd_bwt = round(sd(bwt),1)) %>%
  mutate(race = case_when(race == 1 ~ "Белые",
                          race == 2 ~ "Афроамериканские"))

kable(table_race,
      col.names = c("Раса матери", "Количество", "Средний вес (г)", "Стандартное отклонение (г)"),
      digits = 1,
      caption = "**Средний вес новорождённых у разных рас**")
```

Средний вес новорождённых у белых матерей составил 3103 г, тогда как у афроамериканских — 2720 г.

Следовательно, у детей афроамериканских матерей наблюдается **меньший** вес средний вес при рождении.

Рисунок 1 иллюстрирует распределение и разброс значений веса новорождённых по группам матерей.

```{r plot1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap= "Рис. 1. Распределения веса новорождённых в зависимости от расы матери"}
boxplot(bwt ~ race,
        data = birthwt,
        subset = race %in% c(1, 2),
        names = c("Белые", "Афроамериканские"),
        ylab = "Вес новорождённого, г",
        xlab = "Раса матери")
```

## Регрессионные модели

### Курящие матери

Для курящих матерей была построена линейная модель веса новорождённого в зависимости от возраста матери.

Коэффициент модели оказался отрицательным, при этом **p = 0.22**, что указывает на *отсутствие статистически значимой зависимости* между возрастом матери и весом новорождённого.

```{r test2.1, echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
smokers <- birthwt %>% filter(smoke == 1)

model_smoke <- lm(bwt ~ age, data = smokers)
summary(model_smoke)
```

```{r plot2.1, echo=FALSE, warning=FALSE, message=FALSE, fig.cap= "Рис. 2.Модель веса новорождённого в зависимости от возраста курящей матери"}
plot(bwt ~ age,
     data = smokers,
     xlab = "Возраст матери, лет",
     ylab = "Вес новорождённого, г")
abline(model_smoke)
```

### Некурящие матери
Для некурящих матерей коэффициент модели оказался положительным, а **p = 0.031**, что свидетельствует о наличии *статистически значимой зависимости*.

```{r test2.2, echo=FALSE, warning=FALSE, message=FALSE, include=FALSE}
nonsmokers <- birthwt %>% filter(smoke == 0)

model_nonsmoke <- lm(bwt ~ age, data = nonsmokers)
summary(model_nonsmoke)
```

```{r plot2.2, echo=FALSE, warning=FALSE, message=FALSE, fig.cap= "Рис. 3. Модель веса новорождённого в зависимости от возраста некурящей матери"}
plot(bwt ~ age,
     data = nonsmokers,
     xlab = "Возраст матери, лет",
     ylab = "Вес новорождённого, г")
abline(model_nonsmoke)
```

Рисунок 4 показывает распределение веса новорождённых в зависимости от возраста матери и линии регрессии для курящих и некурящих матерей.

```{r plot2.3, echo=FALSE, message=FALSE, warning=FALSE, fig.cap="Рис. 4. Общее распределение веса новорождённых в зависимости от возраста и статуса курения матери"}
ggplot(birthwt, aes(x = age, y = bwt, color = factor(smoke))) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  scale_color_manual(values = c("green3", "red2"),
                     labels = c("Некурящие", "Курящие")) +
  labs(
    x = "Возраст матери, лет",
    y = "Вес новорождённого, г",
    color = "Статус курения"
  ) +
  theme_minimal()
```

# Обсуждение

В ходе проведённого анализа было выявлено статистически значимое различие массы тела новорождённых у белых и афроамериканских матерей: средний вес при рождении у детей афроамериканских матерей оказался ниже. Данный результат согласуется с ранее опубликованными исследованиями [@alexander_1999].

Анализ регрессионных моделей показал, что в группе курящих матерей статистически значимая связь между возрастом матери и весом новорождённого отсутствует. Подобные выводы ранее были сделаны в работах, посвящённых влиянию курения на рост плода [@horta_1997].

В группе некурящих матерей, напротив, была выявлена статистически значимая положительная связь между возрастом матери и массой тела новорождённого. Это указывает на то, что при отсутствии курения возраст матери может выступать фактором, ассоциированным с увеличением веса новорождённого, что согласуется с результатами ранее опубликованных эмпирических работ [@wilcox_2001].

Полученные результаты демонстрируют статистически значимые различия веса при рождении в зависимости от расовой принадлежности и статуса курения матери, а также подчёркивают целесообразность дальнейшего анализа данных с использованием расширенных моделей.

# Список литературы

